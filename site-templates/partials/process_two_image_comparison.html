{% block head %}
{% load bootstrap4 %}
{% bootstrap_css %}
{% bootstrap_javascript jquery='tiny' %}
{% load static %}
{% bootstrap_messages %}
<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<style>
    /* Bootstrap Toggle v2.2.2 corrections for Bootsrtap 4*/
    .toggle-off {
    box-shadow: inset 0 3px 5px rgba(0, 0, 0, .125);
    }
    .toggle.off {
    border-color: rgba(0, 0, 0, .25);
    }

    .toggle-handle {
    background-color: white;
    border: thin rgba(0, 0, 0, .25) solid;
    }
    .img-responsive {
    width: 350px;
    height: auto;
    }

</style>
<script type="text/javascript">
    $(document).ready(function(){
        $('html').keypress(function(event) {
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if ((keycode >= 48) & (keycode <= 57)) {
                handle_keypress(this, keycode, "click");
                validate_save_button();
            }
            event.stopPropagation();
        });

        $('html').keydown(function(event) {
            var button_field = document.querySelector('button');
            if ((event.keyCode == 13)  && (!button_field.disabled)){
                this.querySelector('.form').submit();
                return false;
             }
        });
        validate_save_button()
    });

    function handle_keypress(element, keycode, myEvent){
        var input_number = keycode - 48;
        var element = '#label_select_' + input_number;
        var state = $(element).prop('checked');
        $(element).prop('checked', !state).change();
    }

    function validate_save_button(){
        var validation_field = $('#label_select_0');
        var button_field = document.querySelector('button');
        if(validation_field.prop('checked') == button_field.disabled){
            button_field.disabled = !validation_field.prop('checked');
        }
    }

    $(document).ready(function() {

    });

</script>
{% endblock %}
{% block process %}
<div class="container-fluid">
    <div class="row">
        {% for task_source in task_sources %}
            {% if forloop.first %}
            <div class="col-sm-10 col-md-4">
                <img src="{{ task_source }}" class="img-thumbnail img-rounded media img-responsive" alt="image"/>
            </div>
            {% endif %}
        {% endfor %}
        <div class="col-sm-10 col-md-4">
            <h4>Which image is/has more?</h4>
            <div class="col-md-12">
                <form action="{% url 'process' dataset.id %}" method="post" class="form">
                    {% csrf_token %}
                    {% bootstrap_form form %}
                    <input type="hidden" name="task" value="{{ task }}"/>
                    <button type="submit" class="btn btn-success">Save</button>
                </form>
            </div>
        </div>
        {% for task_source in task_sources %}
            {% if forloop.last %}
            <div class="col-sm-10 col-md-4">
                <img src="{{ task_source }}" class="img-thumbnail img-rounded media img-responsive" alt="image"/>
            </div>
            {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}